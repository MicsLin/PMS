import{u as e,g as t,c as a,l,J as s,m as r,T as n,o as i,a as o,d as c,F as d,q as u,U as p,n as v,t as g,j as h,s as f,x as m,S as x,e as y,f as w,y as k,k as b,K as L,p as T,i as B,G as I,b as P}from"./vendor.5e620042.js";import{b as S,_ as N,P as A,m as C,d as E}from"./index.42c5c041.js";const O={class:"flex justify-center gap-5 text-sm"},_=["onClick"],j=c("section",{id:"chartProduct",class:"relative"},null,-1),$={props:{data:Object,breakTime:Object,timeRange:Object,sumPiece:Object},setup(f){const m=f,x=e(),y=t(),w=a((()=>y.locale.value)),k=a((()=>x.state.lineBalance.processId)),b=a((()=>x.state.lineBalance.target));const L=new class{constructor(){this.width="100%",this.height=250,this.padding={top:10,right:15,bottom:20,left:55},this.y={isShowingAxis:!1,isLimited:!1,max:1e3,isNice:!0,ticks:10,tickLength:10,fontSize:"12px"},this.x={isShowingAxis:!1,isNice:!1,ticks:10,tickPadding:10,tickLength:10,fontSize:"12px"}}setPaddingLeft(e){return this.padding.left=e>=1e5?75:e>=1e4?65:55}},T=l({piece:{gradient:{start:"#0000004d",stop:"#1f96f099"},stroke:"#2eadf199",strokeWidth:1.5,isHidden:!1,label:{tw:"完成",cn:"完成",jp:"終了",en:"Unit"}},target:{gradient:{start:"#a8d6ff1a",stop:"#a8d6ff1a"},stroke:"#a8d6ff",strokeWidth:1.5,isHidden:!1,label:{tw:"目標",cn:"目标",jp:"目標",en:"Target"}}}),B=a((()=>Object.keys(T.value).map((e=>({key:e,value:T.value[e].label[w.value]||""}))))),I=a((()=>{let e=m.breakTime||{};return{clockIn:e.clockIn||"08:00",clockOut:e.clockOut||"17:00",noonBreakTimeStart:e.noonBreakTimeStart||"12:00",noonBreakTimeEnd:e.noonBreakTimeEnd||"13:00",afternoonBreakTimeStart:e.afternoonBreakTimeStart||"00:00",afternoonBreakTimeEnd:e.afternoonBreakTimeEnd||"00:00"}})),P=a((()=>{let e=["08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00"],t=m.timeRange;return Array.isArray(t)&&t.length>0&&(e=t.map((e=>e.slice(0,5)))),e})),N=a((()=>m.sumPiece||{})),A=a((()=>m.data||{})),C=a((()=>P.value.map((e=>S(e))))),E=a((()=>{let e=[],t=A.value[k.value],a=Array.isArray(t)?t:[];for(let l=0;l<a.length;l++){let t=a[l]||{},s=t.piece;if(null==s)break;let r=t.xLabel?t.xLabel.slice(0,5):"";e.push({xLabel:S(r),piece:s})}if(e.length>0){let t=N.value[k.value]||0;e[e.length-1].piece=t,a.length>e.length&&(e[e.length-1].xLabel=890)}return e})),$=a((()=>{let e=[];if(!b.value)return e;let t=P.value.findIndex((e=>e==I.value.clockIn)),a=P.value.findIndex((e=>e==I.value.clockOut)),l=P.value.findIndex((e=>e==I.value.noonBreakTimeStart)),s=P.value.findIndex((e=>e==I.value.noonBreakTimeEnd)),r=P.value.findIndex((e=>e==I.value.afternoonBreakTimeStart)),n=P.value.findIndex((e=>e==I.value.afternoonBreakTimeEnd));-1==n&&(n=a);let i=s>l&&l>-1,o=n>r&&r>-1,c=t,d=a,u=d-c;if(i&&(u-=s-l),o&&a>r){u-=(n>a?a:n)-r}let p=Math.ceil(b.value/u),v=0;for(let g=c;g<=d;g++){let t={xLabel:C.value[g],piece:v};e[g]=t,i&&g>=l&&s>g||o&&g>=r&&n>g||(v+=p)}return e[e.length-1].piece=b.value,e})),D=a((()=>{let e=C.value.flat(1/0);return d3.extent(e)})),M=a((()=>{let e=L.y.max;if(T.value.target.isHidden&&T.value.piece.isHidden)return[0,e];let t=[T.value.target.isHidden?null:b.value,E.value.map((e=>e.piece))].flat(1/0),a=d3.extent(t);return L.setPaddingLeft(Number(a[1])),L.y.isLimited||(e=Number(a[1])||e),[0,e]})),R=l(N.value[k.value]),F=l(!1),z=l(0),H=()=>z.value=window.innerWidth;return s((()=>{const e=d3.select("#chartProduct").append("div").style("position","absolute").style("pointer-events","none"),t=d3.bisector((e=>e)).left,a=()=>{(()=>{let e={key:"product",targetData:$.value,pieceData:E.value};x.commit("updateLineBalance",e)})(),d3.select("#chartProduct svg").remove();const a=d3.select("#chartProduct").append("svg").attr("width",L.width).attr("height",L.height),l=parseInt(d3.select("#chartProduct svg").style("width")),s=L.height-L.padding.bottom,r=d3.scaleLinear().domain(D.value).range([L.padding.left,l-L.padding.right]),n=d3.axisBottom(r).tickValues(C.value).tickSizeOuter(0).tickSizeInner(-(s+L.x.tickLength)).tickPadding(L.x.tickPadding+1).tickFormat(((e,t)=>P.value[t]));a.append("g").call(n).style("font-size",L.x.fontSize).attr("color","white").attr("transform",`translate(0,${s})`).selectAll(".tick>line").attr("transform",((e,t)=>`translate(0,${L.x.tickLength})`)).attr("opacity",((e,t)=>0==t?1:.2));const i=d3.scaleLinear().domain(M.value).range([s,L.padding.top]);L.y.isNice&&i.nice();const o=d3.axisLeft(i).ticks(L.y.ticks).tickSizeOuter(0).tickSizeInner(L.y.tickLength);a.append("g").call(o).style("font-size",L.y.fontSize).attr("color","white").attr("transform",`translate(${L.padding.left},0)`).selectAll(".tick>line").attr("opacity",((e,t)=>0==t?1:0));const c=a.append("defs");B.value.forEach((e=>{let t=e.key,l=T.value[t]||{};if(!l.isHidden){let e={piece:E.value,target:$.value};c.append("linearGradient").attr("id",`${t}Gradient`).attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",L.padding.top).attr("x2",0).attr("y2",s).selectAll("stop").data([{offset:"0%",color:l.gradient.start},{offset:"100%",color:l.gradient.stop}]).join("stop").attr("offset",(function(e){return e.offset})).attr("stop-color",(function(e){return e.color})).attr("stop-opacity",1);let n=a.append("g");n.append("path").attr("fill",`url(#${t}Gradient)`).attr("d",(a=>d3.area().defined(((e,t)=>e)).x(((e,t)=>r(e.xLabel))).y0(i(0)).y1((e=>i(e.piece)))(e[t]))),e[t].forEach((e=>{n.append("circle").attr("fill","none").attr("stroke",T.value[t].stroke).attr("stroke-width",2).attr("cx",r(e.xLabel)).attr("cy",i(e.piece)).attr("r",3)})),n.append("path").attr("fill","none").attr("stroke",T.value[t].stroke).attr("stroke-width",T.value[t].strokeWidth).attr("d",(a=>d3.line().defined(((e,t)=>e)).x(((e,t)=>r(e.xLabel))).y(((e,t)=>i(e.piece)))(e[t])))}})),a.append("rect").style("fill","blue").attr("opacity",0).style("point-events","all").attr("width",L.width).attr("height",L.height).on("mouseover",(t=>e.style("opacity",1))).on("mousemove",(a=>{let l=function(e){let a=r.invert(e),l=t(C.value,a);return l>C.value.length-1&&(l=C.value.length-1),l}(d3.pointer(a)[0]),n=function(t){let a=r(C.value[t]),l=e._groups[0][0].offsetWidth;return t>C.value.length/2&&(a-=l),a.toString()+"px"}(l),i=s/2+"px",o=!(l>C.value.length/2);e.style("left",n).style("top",i).html(`\n                        <div class='flex items-center'>\n                            <div class='${[o?"toolTipTriangle toolTipPaddingY w-3":"toolTipTriangleNone"]}'>\n                               &#9664;\n                            </div>\n                            <div class='toolTipBackGroundColor toolTipPaddingY toolTipBorderRadius'>\n                                <div class='toolTipPaddingX'>${P.value[l]}</div> \n                                <div class="${[T.value.piece.isHidden?"hidden":""]} flex items-center toolTipPaddingX">\n                                    <div class="w-3 h-3 mr-1 rounded-sm border border-light-100" style="background-color:${T.value.piece.stroke};"></div>\n                                    ${T.value.piece.label[w.value]} ${E.value[l]?E.value[l].piece:""}\n                                </div>\n                                <div class="${[T.value.target.isHidden?"hidden":""]} flex items-center toolTipPaddingX">\n                                    <div class="w-3 h-3 mr-1 rounded-sm border border-light-100" style="background-color:${T.value.target.stroke};"></div>\n                                    ${T.value.target.label[w.value]} ${$.value[l]?$.value[l].piece:""}\n                                </div>\n                            </div>\n                            <div class='${[o?"toolTipTriangleNone":"toolTipTriangle toolTipPaddingY w-3 relative -left-1 ml-px"]}'>\n                               <span class="spanBorder"> &#9654;</span>\n                            </div>\n                        </div>\n                    `)})).on("mouseout",(t=>e.style("opacity",0)))};a(),r((()=>I.value),(()=>F.value=!0)),r((()=>P.value),(()=>F.value=!0)),r((()=>N.value),(e=>{if(e){let t=e[k.value];t&&t!=R.value&&(F.value=!0,R.value=t)}})),r((()=>A.value),(()=>F.value=!0)),r((()=>k.value),(()=>F.value=!0)),window.addEventListener("resize",H),r((()=>z.value),(()=>F.value=!0)),r((()=>F.value),(e=>{e&&(a(),F.value=!1)}))})),n((()=>{window.removeEventListener("resize",H)})),(e,t)=>(i(),o("main",null,[c("section",O,[(i(!0),o(d,null,u(h(B),((e,t)=>(i(),o("article",{key:"groupLabel"+t,class:"flex items-center cursor-pointer",onClick:t=>((e="")=>{T.value[e]&&(T.value[e].isHidden=!T.value[e].isHidden,F.value=!0)})(e.key)},[c("span",{class:"inline-block w-12 h-1 mr-1",style:p("background-color:"+T.value[e.key].stroke)},null,4),c("span",{class:v([T.value[e.key].isHidden?"line-through decoration-2":""])},g(e.value),3)],8,_)))),128))]),j]))}};const D={viewBox:"0 0 36 36",class:"w-full"},M=(e=>(f("data-v-07fb0656"),e=e(),m(),e))((()=>c("circle",{cx:"18",cy:"18",r:"16",transform:"rotate(-90,18,18)",class:"circle-bg"},null,-1))),R=["stroke-dashoffset"],F={x:"18",y:"18",class:"percentage"},z={x:"18",y:"24",class:"percentage words"};var H=N({props:{data:Number,dataStr:String,info:String},setup(e){const t=e,l=a((()=>{let e=t.data||0;return e>100&&(e=100),e})),s=a((()=>t.dataStr||"")),r=a((()=>t.info||""));return(e,t)=>(i(),o("main",null,[(i(),o("svg",D,[M,c("circle",{cx:"18",cy:"18",r:"16",transform:"rotate(-90,18,18)","stroke-dashoffset":100.531*(100-h(l))/100,class:"circle"},null,8,R),c("text",F,g(h(s)),1),c("text",z,g(e.$t(h(r))),1)]))]))}},[["__scopeId","data-v-07fb0656"]]);const G={id:"lineBalanceBar",class:"relative"},U={class:"absolute xAxisLabelForTextLengthLimit flex items-center"},V=["onClick"];var W=N({props:{data:Object,amountData:Number},setup(t){const p=t;x((e=>({ec1b937c:h(E),"2dfbb0a1":h(A),dd12cb8a:h(C)})));const v=e(),f=a((()=>v.state.lineBalance.target));const m=new class{constructor(){this.width="100%",this.height=250,this.padding={top:20,right:10,bottom:40,left:55},this.y={isShowingAxis:!1,isLimited:!1,max:1e3,isNice:!0,ticks:10},this.x={isShowingAxis:!1,tickPadding:10}}setPaddingLeft(e){return this.padding.left=e>=1e5?75:e>=1e4?65:55}},y=l({barWidth:35,betweenBarsPadding:0}),w=l(0),k=()=>w.value=window.innerWidth,b=a((()=>p.amountData)),L=a((()=>{let e=[];for(let t=0;t<b.value;t++)e.push(t);return e})),T=a((()=>p.data||[])),B=a((()=>T.value.length)),I=a((()=>{let e={processId:[],processName:[],piece:[],sort:[]};return T.value.map((t=>{t&&(e.processId.push(t.ProcessID||""),e.processName.push(t.ProcessName||""),e.piece.push(t.piece),e.sort.push(t.ProcessSort))})),e})),P=l([{key:"piece",display:!0}]),S=a((()=>{let e=[];return P.value.map((t=>{t.display&&e.push(t.key)})),e})),N=a((()=>{let e=m.y.max;if(0==B.value)return[0,e];let t=I.value.piece.flat(1/0),a=d3.extent(t);return m.setPaddingLeft(Number(a[1])),m.y.isLimited||(e=Number(a[1])||e),[0,e]})),A=a((()=>m.height-m.padding.bottom+m.x.tickPadding+"px")),C=a((()=>m.padding.left+"px")),E=a((()=>`calc(100% - ${m.padding.left}px - ${m.padding.right}px)`)),O=e=>{let t=I.value.processId[e],a=I.value.processName[e],l=Number(T.value[e].ProcessTimes)||1,s=Math.ceil(f.value/l),r={key:"process",processId:t,processName:a,target:f.value,processTarget:s};v.commit("updateLineBalance",r)};return s((()=>{const e=()=>{d3.select("#lineBalanceBar svg").remove();const e=d3.select("#lineBalanceBar").append("svg").attr("width",m.width).attr("height",m.height),t=parseInt(d3.select("#lineBalanceBar svg").style("width")),a=d3.scaleBand().domain(L.value).range([m.padding.left,t-m.padding.right]),l=d3.axisBottom(a).tickSize(0).tickPadding(m.x.tickPadding),s=e.append("g").call(l).style("font-size","14px").attr("color","white").attr("transform",`translate(0,${m.height-m.padding.bottom})`);m.x.isShowingAxis||s.select("path").attr("stroke","none"),s.selectAll("text").attr("color","transparent");const r=d3.scaleLinear().domain(N.value).range([m.height-m.padding.bottom,m.padding.top]);m.y.isNice&&r.nice();const n=d3.axisLeft(r).ticks(m.y.ticks).tickSize(0).tickPadding(10),i=e.append("g").call(n).style("font-size","14px").attr("color","white").attr("transform",`translate(${m.padding.left},0)`);m.y.isShowingAxis||i.select("path").attr("stroke","none");const o=a.bandwidth(),c=((e,t)=>{let a=[],l=e+1;for(let s=0;s<l;s++)a.push(s*t+m.padding.left);return a})(b.value,o);y.value.barWidth=.6*o,e.append("g").selectAll("line").data(c).join("line").attr("x1",(e=>e)).attr("x2",(e=>e)).attr("y1",((e,t)=>m.height-m.padding.bottom+8)).attr("y2",m.padding.top).attr("stroke","white").attr("stroke-width",1),e.append("g").selectAll("line").data([0]).join("line").attr("x1",m.padding.left-8).attr("x2",t-m.padding.right).attr("y1",r(0)).attr("y2",r(0)).attr("stroke","white").attr("stroke-width",1);const d=e.append("linearGradient").attr("id","chartProcessLinearGradient").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",1);d.append("stop").attr("offset","0%").attr("stop-color","#00FFFF").attr("stop-opacity",1),d.append("stop").attr("offset","100%").attr("stop-color","#50a5f1").attr("stop-opacity",1);const u=S.value.length,p=y.value.barWidth*u+y.value.betweenBarsPadding*(u-1),v=p/2,g=(o-p)/2,h=d3.scaleBand().domain(S.value).range([0,p]),f=e=>m.y.isLimited&&e>m.y.max?m.y.max:e,x=e.append("g").selectAll("g").data(I.value.processName).join("g").attr("transform",((e,t)=>`translate(${a(t)+g}, 0)`));x.selectAll("rect").data(((e,t)=>S.value.map((e=>({key:e,value:I.value[e][t],index:t}))))).join("rect").attr("x",((e,t)=>h(e.key))).attr("y",(e=>{let t=f(e.value);return r(t)})).attr("rx",3).attr("ry",1).attr("width",y.value.barWidth).attr("height",(e=>{let t=f(e.value);return m.height-m.padding.bottom-r(t)})).attr("fill","url(#chartProcessLinearGradient)").style("cursor","pointer").on("click",(function(e,t){let a=t.index;O(a)})),x.selectAll("text").data(((e,t)=>S.value.map((e=>({key:e,value:I.value[e][t]}))))).join("text").attr("x",((e,t)=>h(e.key)+v)).attr("y",(e=>{let t=f(e.value);return r(t)-5})).style("fill","white").style("font-size","14px").style("font-weight","bold").style("text-anchor","middle").text((e=>e.value))};e(),window.addEventListener("resize",k),r((()=>w.value),(()=>e())),r((()=>I.value),(()=>e()))})),n((()=>{window.removeEventListener("resize",k)})),(e,t)=>(i(),o("main",null,[c("section",G,[c("article",U,[(i(!0),o(d,null,u(h(L),((e,t)=>(i(),o("div",{key:"sort"+t,class:"w-full text-center truncate cursor-pointer",onClick:e=>O(t)},g(h(I).sort[t]),9,V)))),128))])])]))}},[["__scopeId","data-v-11db0d1b"]]);const Y=e=>(f("data-v-70835ad9"),e=e(),m(),e),X={class:"flex border-b-2 border-gray-700"},q=Y((()=>c("div",{class:"w-1/12 text-center"},"ID",-1))),J={class:"w-4/12 sm:w-8/12 text-center"},K=Y((()=>c("div",{class:"w-1/12 sm:hidden text-center"},"TT",-1))),Z=Y((()=>c("div",{class:"w-1/12 sm:hidden text-center"},"CT",-1))),Q=Y((()=>c("div",{class:"w-1/12 sm:hidden text-center"},"M.Amt",-1))),ee=Y((()=>c("div",{class:"w-4/12 sm:w-3/12"},null,-1))),te={class:"w-1/12 text-center"},ae={class:"w-4/12 sm:w-8/12 text-center truncate"},le={key:0,class:"hidden sm:block text-sm"},se={class:"w-1/12 sm:hidden text-center"},re={class:"w-1/12 sm:hidden text-center"},ne={class:"w-4/12 sm:w-3/12"},ie={key:0,class:"w-full flex items-center"},oe={class:"sm:hidden flex w-10/12 linear-gradient rounded-md"},ce={class:"w-2/12 sm:w-full text-center"};var de=N({props:{data:Object,amountData:Number},setup(e){const t=e,s=e=>0===e?e:e||"",r=l({high:{value:1.5,textColor:"text-red-700",icon:"pe-7s-attention pe-lg pe-fw pe-va",iconColor:"text-red-500"},littleHigh:{value:1.2,textColor:"text-yellow-700",icon:"pe-7s-info pe-lg pe-fw pe-va",iconColor:"text-yellow-500"},nice:{value:.9,textColor:"text-green-700",icon:"pe-7s-like2 pe-lg pe-fw pe-va",iconColor:"text-green-500"},fast:{value:.001,textColor:"text-green-400",icon:"pe-7s-smile pe-lg pe-fw pe-va",iconColor:"text-green-400"},noData:{value:0,textColor:"text-red-700",icon:"pe-7s-attention pe-lg pe-fw pe-va",iconColor:"text-red-500"}}),n=a((()=>t.amountData)),p=a((()=>{let e=Array.isArray(t.data)?t.data:[],a=Object.values(r.value),l=[];for(let t=0;t<n.value;t++){let n={major:e[t]?s(e[t].ProcessMajor):"",sort:e[t]?s(e[t].ProcessSort):"",name:e[t]?s(e[t].ProcessName):"",TT:e[t]?s(e[t].TT):"",CT:e[t]?s(e[t].CT):"",machineAmount:e[t]?s(e[t].machineAmount):"",pressure:{isShowing:!1,pressureValue:r.value.high.value,rangeValue:r.value.noData.value,textColor:r.value.noData.textColor,icon:r.value.noData.icon,iconColor:r.value.noData.iconColor}};if(n.name&&(n.pressure.isShowing=!0),n.CT&&n.TT){let e=n.CT/n.TT,t=a.find((t=>e>=t.value));n.pressure.pressureValue=e,n.pressure.rangeValue=t.value,n.pressure.textColor=t.textColor,n.pressure.icon=t.icon,n.pressure.iconColor=t.iconColor}l.push(n)}return l}));return(e,t)=>(i(),o("main",null,[c("section",X,[q,c("div",J,g(e.$t("LineBalance.LB_PROCESSINFO_DESC")),1),K,Z,Q,ee]),c("section",null,[(i(!0),o(d,null,u(h(p),((e,t)=>(i(),o("article",{class:v(["flex items-center py-1 Height",[[1==e.major?"majorText":""],[0==t||t%2==0?"bg-blue-500 bg-opacity-10":""]]]),key:"filteredProcessList"+t},[c("div",te,g(e.sort),1),c("div",ae,[c("p",null,g(e.name),1),e.pressure.isShowing?(i(),o("p",le,[y(" TT : "+g(e.TT)+", CT : ",1),c("span",{class:v(e.pressure.textColor)},g(e.CT),3),y(", M.Amt: "+g(e.machineAmount),1)])):w("",!0)]),c("div",se,g(e.TT),1),c("div",{class:v(["w-1/12 sm:hidden text-center",e.pressure.textColor])},g(e.CT),3),c("div",re,g(e.machineAmount),1),c("div",ne,[e.pressure.isShowing?(i(),o("div",ie,[c("div",oe,[(i(),o(d,null,u(20,(t=>c("div",{key:"indexDiv"+t,class:v(["w-full theHeight border border-gray-900 border-opacity-50 bg-gray-700",[t-1>=e.pressure.pressureValue/r.value.high.value*20?" bg-opacity-90":" bg-opacity-10"]])},null,2))),64))]),c("div",ce,[c("span",{class:v(e.pressure.iconColor)},[c("i",{class:v(e.pressure.icon)},null,2)],2)])])):w("",!0)])],2)))),128))])]))}},[["__scopeId","data-v-70835ad9"]]);const ue=e=>(f("data-v-3ab78555"),e=e(),m(),e),pe={class:"py-2 px-4"},ve={class:"text-lg text-center majorText"},ge={class:"overflow-hidden"},he={class:"relative"},fe={viewBox:"0 0 36 18",stroke:"rgba(16, 185, 129, 0.8)",fill:"none"},me=["r","stroke-dasharray","stroke-dashoffset"],xe=["r","stroke-dasharray","stroke-dashoffset"],ye={class:"absolute bottom-4 left-0 w-full text-center svg_text text-4xl"},we={class:"text-sm"},ke={class:"flex justify-between pt-px"},be={class:"svg_text"},Le={class:"svg_text_none"},Te={class:"text-sm"},Be={class:"mr-2"},Ie={key:0,class:"text-green-400"},Pe=[ue((()=>c("i",{class:"pe-7s-smile pe-lg pe-fw pe-va"},null,-1))),y("Perfect")],Se={key:1,class:"text-green-500"},Ne=[ue((()=>c("i",{class:"pe-7s-like2 pe-lg pe-fw pe-va"},null,-1))),y("good")],Ae={key:2,class:"text-yellow-300"},Ce=[ue((()=>c("i",{class:"pe-7s-info pe-lg pe-fw pe-va"},null,-1))),y("normal")],Ee={key:3,class:"text-red-600"},Oe=[ue((()=>c("i",{class:"pe-7s-attention pe-lg pe-fw pe-va"},null,-1))),y("delay")],_e={class:"flex items-center"},je={class:"flex gap-1 m-w-max"},$e={class:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center"},De={key:0,class:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center"},Me=[ue((()=>c("div",{class:"bg-red-400 w-5 h-5 rounded-full"},null,-1)))],Re={key:1,class:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center"},Fe=[ue((()=>c("div",{class:"bg-yellow-400 w-5 h-5 rounded-full"},null,-1)))],ze={class:"majorText text-3xl font-bold text-right w-full truncate"};var He=N({props:{machineInfo:Object},setup(e){const s=e,r=t(),n=a((()=>r.locale.value)),d=a((()=>s.machineInfo||{}));a((()=>d.value.machineId||""));const u=a((()=>d.value.machineName||""));a((()=>d.value.purchaseYear||"")),l(""),a((()=>d.value.processId||""));const p=a((()=>d.value.processName||"")),f=a((()=>d.value.processMajor||0)),m=a((()=>d.value.processSort)),x=a((()=>{let e=d.value.operator||{},t=e.surName||"",a=e.foreName||"",l=t+a;return"en"==n.value&&(l=a+" "+t),l})),y=a((()=>d.value.GSD||0)),k=a((()=>d.value.CT||0)),b=a((()=>d.value.VA||0)),L=a((()=>d.value.EFF||0)),T=a((()=>d.value.OEE||0)),B=a((()=>d.value.piece||0)),I=a((()=>d.value.utilization||0)),P=a((()=>{let e=d.value.status||{};return{on:e.on||"No",error:e.error||"No",warning:e.warning||"No"}}));const S=l(new class{constructor(){this.piece=100,this.r=16,this.radius=3.14159*this.r,this.single=this.radius/this.piece,this.background=[],this.finish=[]}keepArrayLengthOdd(e){let t=parseInt(e);return t%2==0&&(t+=1),t}setBackground(){let e=[],t=this.keepArrayLengthOdd(this.piece);for(let a=0;a<t;a++)e.push(this.single);e.push(this.radius),this.background=e}setFinish(e){let t=[],a=this.keepArrayLengthOdd(this.piece*e);for(let s=0;s<a;s++)t.push(this.single);let l=(2-e)*this.radius;t.push(l),this.finish=t}}),N=a((()=>(S.value.setBackground(),S.value.background))),A=a((()=>(S.value.setFinish(I.value/100),S.value.finish)));return(e,t)=>(i(),o("main",pe,[c("section",ve,[c("article",ge,g(h(u)),1),c("article",{class:v([1==h(f)?"bg-white bg-opacity-10 rounded":"text-white"])},g(h(m))+" - "+g(h(p)),3)]),c("section",he,[(i(),o("svg",fe,[c("circle",{cx:"18",cy:"19",r:S.value.r,stroke:"#2d2b2b","stroke-width":"4","stroke-dasharray":h(N),"stroke-dashoffset":-S.value.radius,fill:"none"},null,8,me),c("circle",{cx:"18",cy:"19",r:S.value.r,class:"stroke","stroke-width":"4","stroke-dasharray":h(A),"stroke-dashoffset":-S.value.radius,fill:"none"},null,8,xe)])),c("div",ye,[c("p",null,g(h(I))+"%",1),c("p",we,g(e.$t("MachineCard.MAC_UTILIZATION")),1)]),c("div",ke,[c("div",be,g(h(b)),1),c("div",Le,g(h(k)),1)])]),c("section",Te,[c("article",null," GSD : "+g(h(y))+" , CT : "+g(h(k))+" , VA : "+g(h(b)),1),c("article",null,[c("span",Be,"EFF : "+g(h(L))+" %",1),h(L)>=90?(i(),o("span",Ie,Pe)):h(L)>=70?(i(),o("span",Se,Ne)):h(L)>=40?(i(),o("span",Ae,Ce)):(i(),o("span",Ee,Oe))]),c("article",null," OEE : "+g(h(T))+" % ",1),c("article",null,g(e.$t("MachineList.MLIST_OPERATOR"))+" : "+g(h(x)),1),c("article",_e,[c("div",je,[c("div",$e,[c("div",{class:v(["w-5 h-5 rounded-full",["Yes"==h(P).on?"bg-green-btn":"bg-gray-400"]])},null,2)]),"Yes"==h(P).error?(i(),o("div",De,Me)):w("",!0),"Yes"==h(P).warning?(i(),o("div",Re,Fe)):w("",!0)]),c("div",ze,g(h(B)),1)])])]))}},[["__scopeId","data-v-3ab78555"]]);const Ge=e=>(f("data-v-0bb994c7"),e=e(),m(),e),Ue={class:"mainPaddingX text-white grid grid-cols-2 gap-2"},Ve={class:"col-span-2 py-4 px-8 sm:px-4 grid grid-cols-4 xl:grid-cols-2 sm:grid-cols-1 text-lg shadow myBorder"},We={class:"flex items-center overflow-hidden"},Ye={class:"mr-2 whitespace-nowrap"},Xe={class:"font-bold truncate"},qe={class:"flex items-center overflow-hidden"},Je={class:"font-bold truncate"},Ke={class:"flex items-center overflow-hidden"},Ze={key:0},Qe={key:1},et={class:"font-bold truncate"},tt={value:"",disabled:"",hidden:""},at=["value"],lt={key:1},st=[Ge((()=>c("i",{class:"pe-7s-ticket pe-lg pe-va"},null,-1)))],rt={class:"flex items-center overflow-hidden"},nt={class:"mr-2 whitespace-nowrap"},it={class:"font-bold truncate"},ot=[Ge((()=>c("i",{class:"pe-7s-cloud-download pe-lg pe-va"},null,-1)))],ct={class:"col-span-1 lg:col-span-2 py-4 px-8 sm:px-4 myBorder"},dt={class:"py-4 grid grid-cols-3 md:grid-cols-2 text-4xl gap-4"},ut={class:"text-right chart4TextColor truncate"},pt={class:"text-xl"},vt={class:"text-right chart4TextColor truncate"},gt={class:"text-xl"},ht={class:"text-right chart4TextColor md:col-span-2 truncate"},ft={class:"text-xl"},mt={class:"grid grid-cols-4 sm:grid-cols-2 gap-4"},xt={class:"flex flex-row-reverse"},yt={class:"w-9/12 md:w-28"},wt={class:"flex flex-row-reverse"},kt={class:"w-9/12 md:w-28"},bt={class:"flex flex-row-reverse"},Lt={class:"w-9/12 md:w-28"},Tt={class:"flex flex-row-reverse"},Bt={class:"w-9/12 md:w-28"},It={class:"col-span-1 lg:col-span-2 py-4 px-8 sm:px-4 myBorder"},Pt={class:"flex items-center justify-between"},St={key:0,class:"flex items-center justify-end"},Nt=[Ge((()=>c("i",{class:"pe-7s-angle-left pe-2x pe-va pe-fw"},null,-1)))],At={class:"bg-white px-2 py-1 bg-opacity-5 rounded"},Ct=Ge((()=>c("span",{class:"mx-1"},"/",-1))),Et=[Ge((()=>c("i",{class:"pe-7s-angle-right pe-2x pe-va pe-fw"},null,-1)))],Ot={class:"col-span-2 py-4 px-8 sm:px-4 myBorder"};var _t=N({setup(n){const p=e(),f=k();b();const m=t(),x=a((()=>m.locale.value));a((()=>p.state.resData.token)),a((()=>p.state.serverURL));const y=a((()=>f.query.lineId));a((()=>p.state.resData.adminName));const N=a((()=>p.state.refreshMilliSec)),O=a((()=>p.state.lineBalance.processTarget)),_=a((()=>p.state.lineBalance.targetData)),j=a((()=>p.state.lineBalance.pieceData));a((()=>p.state.lineBalance.isRefresh));const D=E().isObject,M=()=>{let e=(new Date).toString();return e.slice(0,3)+e.slice(15,25)},R=()=>window.innerWidth<500?3:6,F=l({}),z=l({}),G=l({}),U=l({}),V=l([]),Y=l([]),X=l([]),q=l({}),J=l({}),K=(e=!1)=>{let t=p.state.fakeData.linebalance[y.value];if(t){F.value=D(t.topList)?t.topList:{},q.value=D(t.productList)?t.productList:{},J.value=D(t.operatorList)?t.operatorList:{},V.value=Array.isArray(t.getMachineList)?t.getMachineList:[],V.value.sort(((e,t)=>e.processSort-t.processSort));let a=Array.isArray(t.getProcessList)?t.getProcessList:[];e||function(){let e={key:"process",processId:"",processNameL:"",target:0,processTarget:0};if(a.length>0){let t=a.find((e=>e&&1==e.ProcessMajor));t&&t.ProcessID&&(e.processId=t.ProcessID,e.processName=t.ProcessName)}F.value.target&&(e.target=Number(F.value.target),e.processTarget=e.target),p.commit("updateLineBalance",e)}(),setTimeout((()=>{Y.value=a,z.value=D(t.breakTime)?t.breakTime:{},G.value=D(t.processSumPiece)?t.processSumPiece:{},X.value=Array.isArray(t.getTimeRange)?t.getTimeRange:[],U.value=D(t.process)?t.process:{}}),0)}};K();const Z=l(M()),Q=a((()=>F.value.lineName||"")),ee=l({isShowing:!1,selectedclpId:""}),te=a((()=>{let e=F.value.productActive||{};return{clpId:Object.keys(e)[0]||"",name:Object.values(e)[0]||""}})),ae=a((()=>{let e=F.value.productPassive||{};return{keys:Object.keys(e),names:Object.values(e)}})),le=a((()=>F.value.notsetMachinesAmount||0)),se=()=>{let e={tw:"確定修改?",cn:"确定修改?",jp:"変更してもよろしいですか?",en:"Are you sure to modify?"},t=e[x.value]||e.en;confirm(t)||(ee.value.selectedclpId="")},re=()=>{},ne=l(R()),ie=l([]),oe=l(new A({rightNowPage:1,amountData:ne.value,minAmountData:ne.value})),ce=()=>{oe.value.previous(),ie.value=oe.value.getListByPage()},ue=()=>{oe.value.next(),ie.value=oe.value.getListByPage()};r((()=>Y.value),(e=>{oe.value.set({searchedeAndSortedListCopy:e}),ie.value=oe.value.getListByPage()}));const pe=a((()=>{let e=0;if(j.value){let t=j.value[j.value.length-1];t&&t.piece&&(e=t.piece)}return e})),ve=a((()=>{let e=0;return pe.value&&O.value&&(e=Math.round(pe.value/O.value*100)),e})),ge=a((()=>{let e={rate:0,total:V.value.length,on:0};if(e.total>0){let t=V.value.filter((e=>e&&e.status&&"Yes"==e.status.on));e.on=t.length,e.rate=Math.round(e.on/e.total*100)}return e})),he=a((()=>{let e={ontimeEffRate:0,avgEffRate:0},t=j.value.length-2;if(t>=0){let a=[];for(let e=0;e<=t;e++){let t=j.value[e].piece||0,l=_.value[e].piece||0;if(t||l){let e=0==l?0:t/l*100;a.push(e)}else;}a.length>0&&(e.ontimeEffRate=Math.round(a[a.length-1]),e.avgEffRate=Math.round(a.reduce(((e,t)=>e+t))/a.length-1))}return e})),fe=a((()=>{if(0==j.value.length||0==_.value.length)return"00:00";let e=z.value.clockOut||"17:00",t=he.value.ontimeEffRate;if(j.value.length<2||0==t)return e;let a=z.value.clockIn||"08:00",l=_.value[0].xLabel||S(a),s=(_.value[_.value.length-1].xLabel||S(e))-l,r=Math.ceil(s/(t/100)),n=j.value.findIndex((e=>e&&e.piece))-1;n<0&&(n=0);let i=_.value[n].xLabel||S(a);return C(i+r)})),me=()=>ne.value=R();s((()=>{window.addEventListener("resize",me)})),L((()=>window.removeEventListener("resize",me))),r((()=>ne.value),(e=>{oe.value.set({rightNowPage:1,amountData:e}),ie.value=oe.value.getListByPage()}));var xe=setInterval((function(){Z.value=M(),K(!0)}),N.value);T((e=>{clearInterval(xe)}));const ye=()=>{};return(e,t)=>(i(),o("main",Ue,[c("section",Ve,[c("article",We,[c("p",Ye,g(e.$t("LineBalance.LB_DATE"))+" : ",1),c("p",Xe,g(Z.value),1)]),c("article",qe,[c("p",{class:"mr-2 whitespace-nowrap cursor-pointer",onClick:ye},g(e.$t("LineBalance.LB_LINE_NAME"))+" : ",1),c("p",Je,g(h(Q)),1)]),c("article",Ke,[c("p",{class:"mr-2 whitespace-nowrap cursor-pointer",onClick:t[0]||(t[0]=()=>ee.value.isShowing=!ee.value.isShowing)},[ee.value.isShowing?(i(),o("span",Ze,g(e.$t("LineBalance.LB_EDIT_ONLINE_PRODUCT"))+" : ",1)):(i(),o("span",Qe,g(e.$t("LineBalance.LB_ONLINE_PRODUCT"))+" : ",1))]),c("p",et,[ee.value.isShowing?B((i(),o("select",{key:0,class:"bg-blue-gray cursor-pointer","onUpdate:modelValue":t[1]||(t[1]=e=>ee.value.selectedclpId=e),onChange:se},[c("option",tt,g(e.$t("ProductMachine.PM_SELECT")),1),(i(!0),o(d,null,u(h(ae).names,((e,t)=>(i(),o("option",{key:"productPassive"+t,value:h(ae).keys[t]},g(e),9,at)))),128))],544)),[[I,ee.value.selectedclpId]]):(i(),o("span",lt,g(h(te).name),1)),h(te).name&&h(ae).names.length>0?(i(),o("span",{key:2,class:"ml-1 text-blue-400 cursor-pointer",onClick:t[2]||(t[2]=()=>ee.value.isShowing=!ee.value.isShowing)},st)):w("",!0)])]),c("article",rt,[c("p",nt,g(e.$t("LineBalance.LB_UNSET_MACHINE"))+" : ",1),c("p",it,g(h(le)),1),h(le)>0?(i(),o("p",{key:0,class:"ml-2 text-blue-400 animate-pulse hover:animate-none cursor-pointer",onClick:re},ot)):w("",!0)])]),c("section",ct,[c("article",null,g(e.$t("GLOBAL.GLOBAL_PRODUCT")),1),c("article",null,[P($,{data:U.value,breakTime:z.value,timeRange:X.value,sumPiece:G.value},null,8,["data","breakTime","timeRange","sumPiece"])]),c("article",dt,[c("div",ut,[c("p",null,g(h(O)),1),c("p",pt,g(e.$t("LineBalance.LB_LINEINFO_TARGET")),1)]),c("div",vt,[c("p",null,g(h(pe)),1),c("p",gt,g(e.$t("LineBalance.LB_LINEINFO_ACHIEVE")),1)]),c("div",ht,[c("p",null,g(h(fe)),1),c("p",ft,g(e.$t("LineBalance.LB_LINEINFO_ETA")),1)])]),c("article",mt,[c("div",xt,[c("div",yt,[P(H,{data:h(ve),dataStr:h(ve)+"%",info:"LineBalance.LB_LINEINFO_ACH"},null,8,["data","dataStr","info"])])]),c("div",wt,[c("div",kt,[P(H,{data:h(ge).rate,dataStr:h(ge).on+" / "+h(ge).total,info:"LineBalance.LB_LINEINFO_ONLINE_MACHINE_NUMBER"},null,8,["data","dataStr","info"])])]),c("div",bt,[c("div",Lt,[P(H,{data:h(he).ontimeEffRate,dataStr:h(he).ontimeEffRate+"%",info:"LineBalance.LB_LINEINFO_EFF"},null,8,["data","dataStr","info"])])]),c("div",Tt,[c("div",Bt,[P(H,{data:h(he).avgEffRate,dataStr:h(he).avgEffRate+"%",info:"LineBalance.LB_LINEINFO_AVGEFF"},null,8,["data","dataStr","info"])])])])]),c("section",It,[c("article",Pt,[c("div",null,g(e.$t("GLOBAL.GLOBAL_PROCESS")),1),oe.value.totalPage>1?(i(),o("div",St,[c("span",null,g(e.$t("LineBalance.LB_PROCESSINFO_PAGES"))+":",1),c("button",{onClick:ce},Nt),c("span",At,[c("span",null,g(oe.value.rightNowPage),1),Ct,c("span",null,g(oe.value.totalPage),1)]),c("button",{onClick:ue},Et)])):w("",!0)]),c("article",null,[P(W,{data:ie.value,amountData:ne.value},null,8,["data","amountData"])]),c("article",null,[P(de,{data:ie.value,amountData:ne.value},null,8,["data","amountData"])])]),c("section",Ot,[c("article",null,g(e.$t("GLOBAL.GLOBAL_MACHINE")),1),c("article",{class:v(["grid lg:grid-cols-3 md:grid-cols-2 sm:grid-cols-1",[V.value.length>4?"grid-cols-5 xl:grid-cols-4":"",4==V.value.length?"grid-cols-4":"",3==V.value.length?"grid-cols-3":"",V.value.length<=2?"grid-cols-5 xl:grid-cols-4":""]])},[(i(!0),o(d,null,u(V.value,((e,t)=>(i(),o("div",{key:"getMachineList"+t,class:"m-auto w-56 cardHeight bg-black bg-opacity-50 border-2 border-gray-800 rounded-lg shadow-xl"},[P(He,{machineInfo:e},null,8,["machineInfo"])])))),128))],2)])]))}},[["__scopeId","data-v-0bb994c7"]]);export{_t as default};
