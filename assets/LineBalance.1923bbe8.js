import{u as e,g as t,c as a,l,J as s,m as r,T as n,o as i,a as o,d as c,F as d,q as u,U as p,n as v,t as g,j as h,s as f,x as m,S as x,e as y,f as w,y as k,k as b,K as L,p as T,i as B,G as I,b as P,I as S}from"./vendor.5e620042.js";import{b as N,_ as A,P as C,m as E,d as O,i as _,e as j}from"./index.4332a85f.js";const D={class:"flex justify-center gap-5 text-sm"},$=["onClick"],F=c("section",{id:"chartProduct",class:"relative"},null,-1),M={props:{data:Object,breakTime:Object,timeRange:Object,sumPiece:Object},setup(f){const m=f,x=e(),y=t(),w=a((()=>y.locale.value)),k=a((()=>x.state.lineBalance.processId)),b=a((()=>x.state.lineBalance.target));const L=new class{constructor(){this.width="100%",this.height=250,this.padding={top:10,right:15,bottom:20,left:55},this.y={isShowingAxis:!1,isLimited:!1,max:1e3,isNice:!0,ticks:10,tickLength:10,fontSize:"12px"},this.x={isShowingAxis:!1,isNice:!1,ticks:10,tickPadding:10,tickLength:10,fontSize:"12px"}}setPaddingLeft(e){return this.padding.left=e>=1e5?75:e>=1e4?65:55}},T=l({piece:{gradient:{start:"#0000004d",stop:"#1f96f099"},stroke:"#2eadf199",strokeWidth:1.5,isHidden:!1,label:{tw:"完成",cn:"完成",jp:"終了",en:"Unit"}},target:{gradient:{start:"#a8d6ff1a",stop:"#a8d6ff1a"},stroke:"#a8d6ff",strokeWidth:1.5,isHidden:!1,label:{tw:"目標",cn:"目标",jp:"目標",en:"Target"}}}),B=a((()=>Object.keys(T.value).map((e=>({key:e,value:T.value[e].label[w.value]||""}))))),I=a((()=>{let e=m.breakTime||{};return{clockIn:e.clockIn||"08:00",clockOut:e.clockOut||"17:00",noonBreakTimeStart:e.noonBreakTimeStart||"12:00",noonBreakTimeEnd:e.noonBreakTimeEnd||"13:00",afternoonBreakTimeStart:e.afternoonBreakTimeStart||"00:00",afternoonBreakTimeEnd:e.afternoonBreakTimeEnd||"00:00"}})),P=a((()=>{let e=["08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00"],t=m.timeRange;return Array.isArray(t)&&t.length>0&&(e=t.map((e=>e.slice(0,5)))),e})),S=a((()=>m.sumPiece||{})),A=a((()=>m.data||{})),C=a((()=>P.value.map((e=>N(e))))),E=a((()=>{let e=[],t=A.value[k.value],a=Array.isArray(t)?t:[];for(let l=0;l<a.length;l++){let t=a[l]||{},s=t.piece;if(null==s)break;let r=t.xLabel?t.xLabel.slice(0,5):"";e.push({xLabel:N(r),piece:s})}if(e.length>0){let t=new Date,l=S.value[k.value]||0;e[e.length-1].piece=l,a.length>e.length&&(e[e.length-1].xLabel=60*t.getHours()+t.getMinutes())}return e})),O=a((()=>{let e=[];if(!b.value)return e;let t=P.value.findIndex((e=>e==I.value.clockIn)),a=P.value.findIndex((e=>e==I.value.clockOut)),l=P.value.findIndex((e=>e==I.value.noonBreakTimeStart)),s=P.value.findIndex((e=>e==I.value.noonBreakTimeEnd)),r=P.value.findIndex((e=>e==I.value.afternoonBreakTimeStart)),n=P.value.findIndex((e=>e==I.value.afternoonBreakTimeEnd));-1==n&&(n=a);let i=s>l&&l>-1,o=n>r&&r>-1,c=t,d=a,u=d-c;if(i&&(u-=s-l),o&&a>r){u-=(n>a?a:n)-r}let p=Math.ceil(b.value/u),v=0;for(let g=c;g<=d;g++){let t={xLabel:C.value[g],piece:v};e[g]=t,i&&g>=l&&s>g||o&&g>=r&&n>g||(v+=p)}return e[e.length-1].piece=b.value,e})),_=a((()=>{let e=C.value.flat(1/0);return d3.extent(e)})),j=a((()=>{let e=L.y.max;if(T.value.target.isHidden&&T.value.piece.isHidden)return[0,e];let t=[T.value.target.isHidden?null:b.value,E.value.map((e=>e.piece))].flat(1/0),a=d3.extent(t);return L.setPaddingLeft(Number(a[1])),L.y.isLimited||(e=Number(a[1])||e),[0,e]})),M=l(S.value[k.value]),R=l(!1),z=l(0),H=()=>z.value=window.innerWidth;return s((()=>{const e=d3.select("#chartProduct").append("div").style("position","absolute").style("pointer-events","none"),t=d3.bisector((e=>e)).left,a=()=>{(()=>{let e={key:"product",targetData:O.value,pieceData:E.value};x.commit("updateLineBalance",e)})(),d3.select("#chartProduct svg").remove();const a=d3.select("#chartProduct").append("svg").attr("width",L.width).attr("height",L.height),l=parseInt(d3.select("#chartProduct svg").style("width")),s=L.height-L.padding.bottom,r=d3.scaleLinear().domain(_.value).range([L.padding.left,l-L.padding.right]),n=d3.axisBottom(r).tickValues(C.value).tickSizeOuter(0).tickSizeInner(-(s+L.x.tickLength)).tickPadding(L.x.tickPadding+1).tickFormat(((e,t)=>P.value[t]));a.append("g").call(n).style("font-size",L.x.fontSize).attr("color","white").attr("transform",`translate(0,${s})`).selectAll(".tick>line").attr("transform",((e,t)=>`translate(0,${L.x.tickLength})`)).attr("opacity",((e,t)=>0==t?1:.2));const i=d3.scaleLinear().domain(j.value).range([s,L.padding.top]);L.y.isNice&&i.nice();const o=d3.axisLeft(i).ticks(L.y.ticks).tickSizeOuter(0).tickSizeInner(L.y.tickLength);a.append("g").call(o).style("font-size",L.y.fontSize).attr("color","white").attr("transform",`translate(${L.padding.left},0)`).selectAll(".tick>line").attr("opacity",((e,t)=>0==t?1:0));const c=a.append("defs");B.value.forEach((e=>{let t=e.key,l=T.value[t]||{};if(!l.isHidden){let e={piece:E.value,target:O.value};c.append("linearGradient").attr("id",`${t}Gradient`).attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",L.padding.top).attr("x2",0).attr("y2",s).selectAll("stop").data([{offset:"0%",color:l.gradient.start},{offset:"100%",color:l.gradient.stop}]).join("stop").attr("offset",(function(e){return e.offset})).attr("stop-color",(function(e){return e.color})).attr("stop-opacity",1);let n=a.append("g");n.append("path").attr("fill",`url(#${t}Gradient)`).attr("d",(a=>d3.area().defined(((e,t)=>e)).x(((e,t)=>r(e.xLabel))).y0(i(0)).y1((e=>i(e.piece)))(e[t]))),e[t].forEach((e=>{n.append("circle").attr("fill","none").attr("stroke",T.value[t].stroke).attr("stroke-width",2).attr("cx",r(e.xLabel)).attr("cy",i(e.piece)).attr("r",3)})),n.append("path").attr("fill","none").attr("stroke",T.value[t].stroke).attr("stroke-width",T.value[t].strokeWidth).attr("d",(a=>d3.line().defined(((e,t)=>e)).x(((e,t)=>r(e.xLabel))).y(((e,t)=>i(e.piece)))(e[t])))}})),a.append("rect").style("fill","blue").attr("opacity",0).style("point-events","all").attr("width",L.width).attr("height",L.height).on("mouseover",(t=>e.style("opacity",1))).on("mousemove",(a=>{let l=function(e){let a=r.invert(e),l=t(C.value,a);return l>C.value.length-1&&(l=C.value.length-1),l}(d3.pointer(a)[0]),n=function(t){let a=r(C.value[t]),l=e._groups[0][0].offsetWidth;return t>C.value.length/2&&(a-=l),a.toString()+"px"}(l),i=s/2+"px",o=!(l>C.value.length/2);e.style("left",n).style("top",i).html(`\n                        <div class='flex items-center'>\n                            <div class='${[o?"toolTipTriangle toolTipPaddingY w-3":"toolTipTriangleNone"]}'>\n                               &#9664;\n                            </div>\n                            <div class='toolTipBackGroundColor toolTipPaddingY toolTipBorderRadius'>\n                                <div class='toolTipPaddingX'>${P.value[l]}</div> \n                                <div class="${[T.value.piece.isHidden?"hidden":""]} flex items-center toolTipPaddingX">\n                                    <div class="w-3 h-3 mr-1 rounded-sm border border-light-100" style="background-color:${T.value.piece.stroke};"></div>\n                                    ${T.value.piece.label[w.value]} ${E.value[l]?E.value[l].piece:""}\n                                </div>\n                                <div class="${[T.value.target.isHidden?"hidden":""]} flex items-center toolTipPaddingX">\n                                    <div class="w-3 h-3 mr-1 rounded-sm border border-light-100" style="background-color:${T.value.target.stroke};"></div>\n                                    ${T.value.target.label[w.value]} ${O.value[l]?O.value[l].piece:""}\n                                </div>\n                            </div>\n                            <div class='${[o?"toolTipTriangleNone":"toolTipTriangle toolTipPaddingY w-3 relative -left-1 ml-px"]}'>\n                               <span class="spanBorder"> &#9654;</span>\n                            </div>\n                        </div>\n                    `)})).on("mouseout",(t=>e.style("opacity",0)))};a(),r((()=>I.value),(()=>R.value=!0)),r((()=>P.value),(()=>R.value=!0)),r((()=>S.value),(e=>{if(e){let t=e[k.value];t&&t!=M.value&&(R.value=!0,M.value=t)}})),r((()=>A.value),(()=>R.value=!0)),r((()=>k.value),(()=>R.value=!0)),window.addEventListener("resize",H),r((()=>z.value),(()=>R.value=!0)),r((()=>R.value),(e=>{e&&(a(),R.value=!1)}))})),n((()=>{window.removeEventListener("resize",H)})),(e,t)=>(i(),o("main",null,[c("section",D,[(i(!0),o(d,null,u(h(B),((e,t)=>(i(),o("article",{key:"groupLabel"+t,class:"flex items-center cursor-pointer",onClick:t=>((e="")=>{T.value[e]&&(T.value[e].isHidden=!T.value[e].isHidden,R.value=!0)})(e.key)},[c("span",{class:"inline-block w-12 h-1 mr-1",style:p("background-color:"+T.value[e.key].stroke)},null,4),c("span",{class:v([T.value[e.key].isHidden?"line-through decoration-2":""])},g(e.value),3)],8,$)))),128))]),F]))}};const R={viewBox:"0 0 36 36",class:"w-full"},z=(e=>(f("data-v-07fb0656"),e=e(),m(),e))((()=>c("circle",{cx:"18",cy:"18",r:"16",transform:"rotate(-90,18,18)",class:"circle-bg"},null,-1))),H=["stroke-dashoffset"],G={x:"18",y:"18",class:"percentage"},U={x:"18",y:"24",class:"percentage words"};var V=A({props:{data:Number,dataStr:String,info:String},setup(e){const t=e,l=a((()=>{let e=t.data||0;return e>100&&(e=100),e})),s=a((()=>t.dataStr||"")),r=a((()=>t.info||""));return(e,t)=>(i(),o("main",null,[(i(),o("svg",R,[z,c("circle",{cx:"18",cy:"18",r:"16",transform:"rotate(-90,18,18)","stroke-dashoffset":100.531*(100-h(l))/100,class:"circle"},null,8,H),c("text",G,g(h(s)),1),c("text",U,g(e.$t(h(r))),1)]))]))}},[["__scopeId","data-v-07fb0656"]]);const W={id:"lineBalanceBar",class:"relative"},Y={class:"absolute xAxisLabelForTextLengthLimit flex items-center"},X=["onClick"];var q=A({props:{data:Object,amountData:Number},setup(t){const p=t;x((e=>({ec1b937c:h(E),"2dfbb0a1":h(A),dd12cb8a:h(C)})));const v=e(),f=a((()=>v.state.lineBalance.target));const m=new class{constructor(){this.width="100%",this.height=250,this.padding={top:20,right:10,bottom:40,left:55},this.y={isShowingAxis:!1,isLimited:!1,max:1e3,isNice:!0,ticks:10},this.x={isShowingAxis:!1,tickPadding:10}}setPaddingLeft(e){return this.padding.left=e>=1e5?75:e>=1e4?65:55}},y=l({barWidth:35,betweenBarsPadding:0}),w=l(0),k=()=>w.value=window.innerWidth,b=a((()=>p.amountData)),L=a((()=>{let e=[];for(let t=0;t<b.value;t++)e.push(t);return e})),T=a((()=>p.data||[])),B=a((()=>T.value.length)),I=a((()=>{let e={processId:[],processName:[],piece:[],sort:[]};return T.value.map((t=>{t&&(e.processId.push(t.ProcessID||""),e.processName.push(t.ProcessName||""),e.piece.push(t.piece),e.sort.push(t.ProcessSort))})),e})),P=l([{key:"piece",display:!0}]),S=a((()=>{let e=[];return P.value.map((t=>{t.display&&e.push(t.key)})),e})),N=a((()=>{let e=m.y.max;if(0==B.value)return[0,e];let t=I.value.piece.flat(1/0),a=d3.extent(t);return m.setPaddingLeft(Number(a[1])),m.y.isLimited||(e=Number(a[1])||e),[0,e]})),A=a((()=>m.height-m.padding.bottom+m.x.tickPadding+"px")),C=a((()=>m.padding.left+"px")),E=a((()=>`calc(100% - ${m.padding.left}px - ${m.padding.right}px)`)),O=e=>{let t=I.value.processId[e],a=I.value.processName[e],l=Number(T.value[e].ProcessTimes)||1,s=Math.ceil(f.value/l),r={key:"process",processId:t,processName:a,target:f.value,processTarget:s};v.commit("updateLineBalance",r)};return s((()=>{const e=()=>{d3.select("#lineBalanceBar svg").remove();const e=d3.select("#lineBalanceBar").append("svg").attr("width",m.width).attr("height",m.height),t=parseInt(d3.select("#lineBalanceBar svg").style("width")),a=d3.scaleBand().domain(L.value).range([m.padding.left,t-m.padding.right]),l=d3.axisBottom(a).tickSize(0).tickPadding(m.x.tickPadding),s=e.append("g").call(l).style("font-size","14px").attr("color","white").attr("transform",`translate(0,${m.height-m.padding.bottom})`);m.x.isShowingAxis||s.select("path").attr("stroke","none"),s.selectAll("text").attr("color","transparent");const r=d3.scaleLinear().domain(N.value).range([m.height-m.padding.bottom,m.padding.top]);m.y.isNice&&r.nice();const n=d3.axisLeft(r).ticks(m.y.ticks).tickSize(0).tickPadding(10),i=e.append("g").call(n).style("font-size","14px").attr("color","white").attr("transform",`translate(${m.padding.left},0)`);m.y.isShowingAxis||i.select("path").attr("stroke","none");const o=a.bandwidth(),c=((e,t)=>{let a=[],l=e+1;for(let s=0;s<l;s++)a.push(s*t+m.padding.left);return a})(b.value,o);y.value.barWidth=.6*o,e.append("g").selectAll("line").data(c).join("line").attr("x1",(e=>e)).attr("x2",(e=>e)).attr("y1",((e,t)=>m.height-m.padding.bottom+8)).attr("y2",m.padding.top).attr("stroke","white").attr("stroke-width",1),e.append("g").selectAll("line").data([0]).join("line").attr("x1",m.padding.left-8).attr("x2",t-m.padding.right).attr("y1",r(0)).attr("y2",r(0)).attr("stroke","white").attr("stroke-width",1);const d=e.append("linearGradient").attr("id","chartProcessLinearGradient").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",1);d.append("stop").attr("offset","0%").attr("stop-color","#00FFFF").attr("stop-opacity",1),d.append("stop").attr("offset","100%").attr("stop-color","#50a5f1").attr("stop-opacity",1);const u=S.value.length,p=y.value.barWidth*u+y.value.betweenBarsPadding*(u-1),v=p/2,g=(o-p)/2,h=d3.scaleBand().domain(S.value).range([0,p]),f=e=>m.y.isLimited&&e>m.y.max?m.y.max:e,x=e.append("g").selectAll("g").data(I.value.processName).join("g").attr("transform",((e,t)=>`translate(${a(t)+g}, 0)`));x.selectAll("rect").data(((e,t)=>S.value.map((e=>({key:e,value:I.value[e][t],index:t}))))).join("rect").attr("x",((e,t)=>h(e.key))).attr("y",(e=>{let t=f(e.value);return r(t)})).attr("rx",3).attr("ry",1).attr("width",y.value.barWidth).attr("height",(e=>{let t=f(e.value);return m.height-m.padding.bottom-r(t)})).attr("fill","url(#chartProcessLinearGradient)").style("cursor","pointer").on("click",(function(e,t){let a=t.index;O(a)})),x.selectAll("text").data(((e,t)=>S.value.map((e=>({key:e,value:I.value[e][t]}))))).join("text").attr("x",((e,t)=>h(e.key)+v)).attr("y",(e=>{let t=f(e.value);return r(t)-5})).style("fill","white").style("font-size","14px").style("font-weight","bold").style("text-anchor","middle").text((e=>e.value))};e(),window.addEventListener("resize",k),r((()=>w.value),(()=>e())),r((()=>I.value),(()=>e()))})),n((()=>{window.removeEventListener("resize",k)})),(e,t)=>(i(),o("main",null,[c("section",W,[c("article",Y,[(i(!0),o(d,null,u(h(L),((e,t)=>(i(),o("div",{key:"sort"+t,class:"w-full text-center truncate cursor-pointer",onClick:e=>O(t)},g(h(I).sort[t]),9,X)))),128))])])]))}},[["__scopeId","data-v-11db0d1b"]]);const J=e=>(f("data-v-70835ad9"),e=e(),m(),e),K={class:"flex border-b-2 border-gray-700"},Z=J((()=>c("div",{class:"w-1/12 text-center"},"ID",-1))),Q={class:"w-4/12 sm:w-8/12 text-center"},ee=J((()=>c("div",{class:"w-1/12 sm:hidden text-center"},"TT",-1))),te=J((()=>c("div",{class:"w-1/12 sm:hidden text-center"},"CT",-1))),ae=J((()=>c("div",{class:"w-1/12 sm:hidden text-center"},"M.Amt",-1))),le=J((()=>c("div",{class:"w-4/12 sm:w-3/12"},null,-1))),se={class:"w-1/12 text-center"},re={class:"w-4/12 sm:w-8/12 text-center truncate"},ne={key:0,class:"hidden sm:block text-sm"},ie={class:"w-1/12 sm:hidden text-center"},oe={class:"w-1/12 sm:hidden text-center"},ce={class:"w-4/12 sm:w-3/12"},de={key:0,class:"w-full flex items-center"},ue={class:"sm:hidden flex w-10/12 linear-gradient rounded-md"},pe={class:"w-2/12 sm:w-full text-center"};var ve=A({props:{data:Object,amountData:Number},setup(e){const t=e,s=e=>0===e?e:e||"",r=l({high:{value:1.5,textColor:"text-red-700",icon:"pe-7s-attention pe-lg pe-fw pe-va",iconColor:"text-red-500"},littleHigh:{value:1.2,textColor:"text-yellow-700",icon:"pe-7s-info pe-lg pe-fw pe-va",iconColor:"text-yellow-500"},nice:{value:.9,textColor:"text-green-700",icon:"pe-7s-like2 pe-lg pe-fw pe-va",iconColor:"text-green-500"},fast:{value:.001,textColor:"text-green-400",icon:"pe-7s-smile pe-lg pe-fw pe-va",iconColor:"text-green-400"},noData:{value:0,textColor:"text-red-700",icon:"pe-7s-attention pe-lg pe-fw pe-va",iconColor:"text-red-500"}}),n=a((()=>t.amountData)),p=a((()=>{let e=Array.isArray(t.data)?t.data:[],a=Object.values(r.value),l=[];for(let t=0;t<n.value;t++){let n={major:e[t]?s(e[t].ProcessMajor):"",sort:e[t]?s(e[t].ProcessSort):"",name:e[t]?s(e[t].ProcessName):"",TT:e[t]?s(e[t].TT):"",CT:e[t]?s(e[t].CT):"",machineAmount:e[t]?s(e[t].machineAmount):"",pressure:{isShowing:!1,pressureValue:r.value.high.value,rangeValue:r.value.noData.value,textColor:r.value.noData.textColor,icon:r.value.noData.icon,iconColor:r.value.noData.iconColor}};if(n.name&&(n.pressure.isShowing=!0),n.CT&&n.TT){let e=n.CT/n.TT,t=a.find((t=>e>=t.value));n.pressure.pressureValue=e,n.pressure.rangeValue=t.value,n.pressure.textColor=t.textColor,n.pressure.icon=t.icon,n.pressure.iconColor=t.iconColor}l.push(n)}return l}));return(e,t)=>(i(),o("main",null,[c("section",K,[Z,c("div",Q,g(e.$t("LineBalance.LB_PROCESSINFO_DESC")),1),ee,te,ae,le]),c("section",null,[(i(!0),o(d,null,u(h(p),((e,t)=>(i(),o("article",{class:v(["flex items-center py-1 Height",[[1==e.major?"majorText":""],[0==t||t%2==0?"bg-blue-500 bg-opacity-10":""]]]),key:"filteredProcessList"+t},[c("div",se,g(e.sort),1),c("div",re,[c("p",null,g(e.name),1),e.pressure.isShowing?(i(),o("p",ne,[y(" TT : "+g(e.TT)+", CT : ",1),c("span",{class:v(e.pressure.textColor)},g(e.CT),3),y(", M.Amt: "+g(e.machineAmount),1)])):w("",!0)]),c("div",ie,g(e.TT),1),c("div",{class:v(["w-1/12 sm:hidden text-center",e.pressure.textColor])},g(e.CT),3),c("div",oe,g(e.machineAmount),1),c("div",ce,[e.pressure.isShowing?(i(),o("div",de,[c("div",ue,[(i(),o(d,null,u(20,(t=>c("div",{key:"indexDiv"+t,class:v(["w-full theHeight border border-gray-900 border-opacity-50 bg-gray-700",[t-1>=e.pressure.pressureValue/r.value.high.value*20?" bg-opacity-90":" bg-opacity-10"]])},null,2))),64))]),c("div",pe,[c("span",{class:v(e.pressure.iconColor)},[c("i",{class:v(e.pressure.icon)},null,2)],2)])])):w("",!0)])],2)))),128))])]))}},[["__scopeId","data-v-70835ad9"]]);const ge=e=>(f("data-v-3ab78555"),e=e(),m(),e),he={class:"py-2 px-4"},fe={class:"text-lg text-center majorText"},me={class:"overflow-hidden"},xe={class:"relative"},ye={viewBox:"0 0 36 18",stroke:"rgba(16, 185, 129, 0.8)",fill:"none"},we=["r","stroke-dasharray","stroke-dashoffset"],ke=["r","stroke-dasharray","stroke-dashoffset"],be={class:"absolute bottom-4 left-0 w-full text-center svg_text text-4xl"},Le={class:"text-sm"},Te={class:"flex justify-between pt-px"},Be={class:"svg_text"},Ie={class:"svg_text_none"},Pe={class:"text-sm"},Se={class:"mr-2"},Ne={key:0,class:"text-green-400"},Ae=[ge((()=>c("i",{class:"pe-7s-smile pe-lg pe-fw pe-va"},null,-1))),y("Perfect")],Ce={key:1,class:"text-green-500"},Ee=[ge((()=>c("i",{class:"pe-7s-like2 pe-lg pe-fw pe-va"},null,-1))),y("good")],Oe={key:2,class:"text-yellow-300"},_e=[ge((()=>c("i",{class:"pe-7s-info pe-lg pe-fw pe-va"},null,-1))),y("normal")],je={key:3,class:"text-red-600"},De=[ge((()=>c("i",{class:"pe-7s-attention pe-lg pe-fw pe-va"},null,-1))),y("delay")],$e={class:"flex items-center"},Fe={class:"flex gap-1 m-w-max"},Me={class:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center"},Re={key:0,class:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center"},ze=[ge((()=>c("div",{class:"bg-red-400 w-5 h-5 rounded-full"},null,-1)))],He={key:1,class:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center"},Ge=[ge((()=>c("div",{class:"bg-yellow-400 w-5 h-5 rounded-full"},null,-1)))],Ue={class:"majorText text-3xl font-bold text-right w-full truncate"};var Ve=A({props:{machineInfo:Object},setup(e){const s=e,r=t(),n=a((()=>r.locale.value)),d=a((()=>s.machineInfo||{}));a((()=>d.value.machineId||""));const u=a((()=>d.value.machineName||""));a((()=>d.value.purchaseYear||"")),l(""),a((()=>d.value.processId||""));const p=a((()=>d.value.processName||"")),f=a((()=>d.value.processMajor||0)),m=a((()=>d.value.processSort)),x=a((()=>{let e=d.value.operator||{},t=e.surName||"",a=e.foreName||"",l=t+a;return"en"==n.value&&(l=a+" "+t),l})),y=a((()=>d.value.GSD||0)),k=a((()=>d.value.CT||0)),b=a((()=>d.value.VA||0)),L=a((()=>d.value.EFF||0)),T=a((()=>d.value.OEE||0)),B=a((()=>d.value.piece||0)),I=a((()=>d.value.utilization||0)),P=a((()=>{let e=d.value.status||{};return{on:e.on||"No",error:e.error||"No",warning:e.warning||"No"}}));const S=l(new class{constructor(){this.piece=100,this.r=16,this.radius=3.14159*this.r,this.single=this.radius/this.piece,this.background=[],this.finish=[]}keepArrayLengthOdd(e){let t=parseInt(e);return t%2==0&&(t+=1),t}setBackground(){let e=[],t=this.keepArrayLengthOdd(this.piece);for(let a=0;a<t;a++)e.push(this.single);e.push(this.radius),this.background=e}setFinish(e){let t=[],a=this.keepArrayLengthOdd(this.piece*e);for(let s=0;s<a;s++)t.push(this.single);let l=(2-e)*this.radius;t.push(l),this.finish=t}}),N=a((()=>(S.value.setBackground(),S.value.background))),A=a((()=>(S.value.setFinish(I.value/100),S.value.finish)));return(e,t)=>(i(),o("main",he,[c("section",fe,[c("article",me,g(h(u)),1),c("article",{class:v([1==h(f)?"bg-white bg-opacity-10 rounded":"text-white"])},g(h(m))+" - "+g(h(p)),3)]),c("section",xe,[(i(),o("svg",ye,[c("circle",{cx:"18",cy:"19",r:S.value.r,stroke:"#2d2b2b","stroke-width":"4","stroke-dasharray":h(N),"stroke-dashoffset":-S.value.radius,fill:"none"},null,8,we),c("circle",{cx:"18",cy:"19",r:S.value.r,class:"stroke","stroke-width":"4","stroke-dasharray":h(A),"stroke-dashoffset":-S.value.radius,fill:"none"},null,8,ke)])),c("div",be,[c("p",null,g(h(I))+"%",1),c("p",Le,g(e.$t("MachineCard.MAC_UTILIZATION")),1)]),c("div",Te,[c("div",Be,g(h(b)),1),c("div",Ie,g(h(k)),1)])]),c("section",Pe,[c("article",null," GSD : "+g(h(y))+" , CT : "+g(h(k))+" , VA : "+g(h(b)),1),c("article",null,[c("span",Se,"EFF : "+g(h(L))+" %",1),h(L)>=90?(i(),o("span",Ne,Ae)):h(L)>=70?(i(),o("span",Ce,Ee)):h(L)>=40?(i(),o("span",Oe,_e)):(i(),o("span",je,De))]),c("article",null," OEE : "+g(h(T))+" % ",1),c("article",null,g(e.$t("MachineList.MLIST_OPERATOR"))+" : "+g(h(x)),1),c("article",$e,[c("div",Fe,[c("div",Me,[c("div",{class:v(["w-5 h-5 rounded-full",["Yes"==h(P).on?"bg-green-btn":"bg-gray-400"]])},null,2)]),"Yes"==h(P).error?(i(),o("div",Re,ze)):w("",!0),"Yes"==h(P).warning?(i(),o("div",He,Ge)):w("",!0)]),c("div",Ue,g(h(B)),1)])])]))}},[["__scopeId","data-v-3ab78555"]]);const We=e=>(f("data-v-d7ee269e"),e=e(),m(),e),Ye={class:"mainPaddingX text-white grid grid-cols-2 gap-2"},Xe={class:"col-span-2 py-4 px-8 sm:px-4 grid grid-cols-4 xl:grid-cols-2 sm:grid-cols-1 text-lg shadow myBorder"},qe={class:"flex items-center overflow-hidden"},Je={class:"mr-2 whitespace-nowrap"},Ke={class:"font-bold truncate"},Ze={class:"flex items-center overflow-hidden"},Qe={class:"font-bold truncate"},et={class:"flex items-center overflow-hidden"},tt={key:0},at={key:1},lt={class:"font-bold truncate"},st={value:"",disabled:"",hidden:""},rt=["value"],nt={key:1},it=[We((()=>c("i",{class:"pe-7s-ticket pe-lg pe-va"},null,-1)))],ot={class:"flex items-center overflow-hidden"},ct={class:"mr-2 whitespace-nowrap"},dt={class:"font-bold truncate"},ut=[We((()=>c("i",{class:"pe-7s-cloud-download pe-lg pe-va"},null,-1)))],pt={class:"col-span-1 lg:col-span-2 py-4 px-8 sm:px-4 myBorder"},vt={class:"py-4 grid grid-cols-3 md:grid-cols-2 text-4xl gap-4"},gt={class:"text-right chart4TextColor truncate"},ht={class:"text-xl"},ft={class:"text-right chart4TextColor truncate"},mt={class:"text-xl"},xt={class:"text-right chart4TextColor md:col-span-2 truncate"},yt={class:"text-xl"},wt={class:"grid grid-cols-4 sm:grid-cols-2 gap-4"},kt={class:"flex flex-row-reverse"},bt={class:"w-9/12 md:w-28"},Lt={class:"flex flex-row-reverse"},Tt={class:"w-9/12 md:w-28"},Bt={class:"flex flex-row-reverse"},It={class:"w-9/12 md:w-28"},Pt={class:"flex flex-row-reverse"},St={class:"w-9/12 md:w-28"},Nt={class:"col-span-1 lg:col-span-2 py-4 px-8 sm:px-4 myBorder"},At={class:"flex items-center justify-between"},Ct={key:0,class:"flex items-center justify-end"},Et=[We((()=>c("i",{class:"pe-7s-angle-left pe-2x pe-va pe-fw"},null,-1)))],Ot={class:"bg-white px-2 py-1 bg-opacity-5 rounded"},_t=We((()=>c("span",{class:"mx-1"},"/",-1))),jt=[We((()=>c("i",{class:"pe-7s-angle-right pe-2x pe-va pe-fw"},null,-1)))],Dt={class:"col-span-2 py-4 px-8 sm:px-4 myBorder"};var $t=A({setup(n){const p=e(),f=k();b();const m=t(),x=a((()=>m.locale.value)),y=a((()=>p.state.resData.token)),A=a((()=>p.state.serverURL)),D=a((()=>f.query.lineId));a((()=>p.state.resData.adminName));const $=a((()=>p.state.refreshMilliSec)),F=a((()=>p.state.lineBalance.processTarget)),R=a((()=>p.state.lineBalance.targetData)),z=a((()=>p.state.lineBalance.pieceData));a((()=>p.state.lineBalance.isRefresh));const H=j().isObject,G=()=>{let e=(new Date).toString();return e.slice(0,3)+e.slice(15,25)},U=()=>window.innerWidth<500?3:6,W=l({}),Y=l({}),X=l({}),J=l({}),K=l([]),Z=l([]),Q=l([]),ee=l({}),te=l({}),ae=(e=!1)=>{let t=p.state.fakeData.linebalance[D.value];if(t){W.value=H(t.topList)?t.topList:{},ee.value=H(t.productList)?t.productList:{},te.value=H(t.operatorList)?t.operatorList:{},K.value=Array.isArray(t.getMachineList)?t.getMachineList:[],K.value.sort(((e,t)=>e.processSort-t.processSort));let a=Array.isArray(t.getProcessList)?t.getProcessList:[];e||function(){let e={key:"process",processId:"",processNameL:"",target:0,processTarget:0};if(a.length>0){let t=a.find((e=>e&&1==e.ProcessMajor));t&&t.ProcessID&&(e.processId=t.ProcessID,e.processName=t.ProcessName)}W.value.target&&(e.target=Number(W.value.target),e.processTarget=e.target),p.commit("updateLineBalance",e)}(),setTimeout((()=>{Z.value=a,Y.value=H(t.breakTime)?t.breakTime:{},X.value=H(t.processSumPiece)?t.processSumPiece:{},Q.value=Array.isArray(t.getTimeRange)?t.getTimeRange:[],J.value=H(t.process)?t.process:{}}),0)}};ae();const le=l(G()),se=a((()=>W.value.lineName||"")),re=l({isShowing:!1,selectedclpId:""}),ne=a((()=>{let e=W.value.productActive||{};return{clpId:Object.keys(e)[0]||"",name:Object.values(e)[0]||""}})),ie=a((()=>{let e=W.value.productPassive||{};return{keys:Object.keys(e),names:Object.values(e)}})),oe=a((()=>W.value.notsetMachinesAmount||0)),ce=()=>{let e={tw:"確定修改?",cn:"确定修改?",jp:"変更してもよろしいですか?",en:"Are you sure to modify?"},t=e[x.value]||e.en;confirm(t)||(re.value.selectedclpId="")},de=()=>{},ue=l(U()),pe=l([]),ge=l(new C({rightNowPage:1,amountData:ue.value,minAmountData:ue.value})),he=()=>{ge.value.previous(),pe.value=ge.value.getListByPage()},fe=()=>{ge.value.next(),pe.value=ge.value.getListByPage()};r((()=>Z.value),(e=>{ge.value.set({searchedeAndSortedListCopy:e}),pe.value=ge.value.getListByPage()}));const me=a((()=>{let e=0;if(z.value){let t=z.value[z.value.length-1];t&&t.piece&&(e=t.piece)}return e})),xe=a((()=>{let e=0;return me.value&&F.value&&(e=Math.round(me.value/F.value*100)),e})),ye=a((()=>{let e={rate:0,total:K.value.length,on:0};if(e.total>0){let t=K.value.filter((e=>e&&e.status&&"Yes"==e.status.on));e.on=t.length,e.rate=Math.round(e.on/e.total*100)}return e})),we=a((()=>{let e={ontimeEffRate:0,avgEffRate:0},t=z.value.length-2;if(t>=0){let a=[];for(let e=0;e<=t;e++){let t=z.value[e].piece||0,l=R.value[e].piece||0;if(t||l){let e=0==l?0:t/l*100;a.push(e)}else;}a.length>0&&(e.ontimeEffRate=Math.round(a[a.length-1]),e.avgEffRate=Math.round(a.reduce(((e,t)=>e+t))/a.length-1))}return e})),ke=a((()=>{if(0==z.value.length||0==R.value.length)return"00:00";let e=Y.value.clockOut||"17:00",t=we.value.ontimeEffRate;if(z.value.length<2||0==t)return e;let a=Y.value.clockIn||"08:00",l=R.value[0].xLabel||N(a),s=(R.value[R.value.length-1].xLabel||N(e))-l,r=Math.ceil(s/(t/100)),n=z.value.findIndex((e=>e&&e.piece))-1;n<0&&(n=0);let i=R.value[n].xLabel||N(a);return E(i+r)})),be=()=>ue.value=U();s((()=>{window.addEventListener("resize",be)})),L((()=>window.removeEventListener("resize",be))),r((()=>ue.value),(e=>{ge.value.set({rightNowPage:1,amountData:e}),pe.value=ge.value.getListByPage()}));var Le=setInterval((function(){le.value=G(),ae(!0)}),$.value);T((e=>{clearInterval(Le)}));const Te=()=>{let e=ne.value.clpId,t=ee.value[e],a=null==t?void 0:t.ProductID;if(!a)return console.warn("product id is wrong");let l=new FormData;l.append("token",y.value),l.append("productId",a),S.post(`http://${A.value}/process.php`,l).then((e=>{if(O(e.data),1==e.data.status){let t=e.data.data,a=null==t?void 0:t.processList;if(!Array.isArray(a))return console.warn("process is wrong");let l=((e=[])=>{let t=[...e],a=_(x.value);return t.map((e=>{if(e&&e.processType){let t=Number(e.processType);e.processTypeTranslation=a[t]||""}return e}))})(a);p.commit("onPopupForm","automaticLineOptimize"),p.commit("onPopupOtherData",l)}else 2==e.data.status?p.dispatch("tokenCheckFail"):console.warn("else")})).catch((e=>{console.error("error")}))};return(e,t)=>(i(),o("main",Ye,[c("section",Xe,[c("article",qe,[c("p",Je,g(e.$t("LineBalance.LB_DATE"))+" : ",1),c("p",Ke,g(le.value),1)]),c("article",Ze,[c("p",{class:"mr-2 whitespace-nowrap cursor-pointer",onClick:Te},g(e.$t("LineBalance.LB_LINE_NAME"))+" : ",1),c("p",Qe,g(h(se)),1)]),c("article",et,[c("p",{class:"mr-2 whitespace-nowrap cursor-pointer",onClick:t[0]||(t[0]=()=>re.value.isShowing=!re.value.isShowing)},[re.value.isShowing?(i(),o("span",tt,g(e.$t("LineBalance.LB_EDIT_ONLINE_PRODUCT"))+" : ",1)):(i(),o("span",at,g(e.$t("LineBalance.LB_ONLINE_PRODUCT"))+" : ",1))]),c("p",lt,[re.value.isShowing?B((i(),o("select",{key:0,class:"bg-blue-gray cursor-pointer","onUpdate:modelValue":t[1]||(t[1]=e=>re.value.selectedclpId=e),onChange:ce},[c("option",st,g(e.$t("ProductMachine.PM_SELECT")),1),(i(!0),o(d,null,u(h(ie).names,((e,t)=>(i(),o("option",{key:"productPassive"+t,value:h(ie).keys[t]},g(e),9,rt)))),128))],544)),[[I,re.value.selectedclpId]]):(i(),o("span",nt,g(h(ne).name),1)),h(ne).name&&h(ie).names.length>0?(i(),o("span",{key:2,class:"ml-1 text-blue-400 cursor-pointer",onClick:t[2]||(t[2]=()=>re.value.isShowing=!re.value.isShowing)},it)):w("",!0)])]),c("article",ot,[c("p",ct,g(e.$t("LineBalance.LB_UNSET_MACHINE"))+" : ",1),c("p",dt,g(h(oe)),1),h(oe)>0?(i(),o("p",{key:0,class:"ml-2 text-blue-400 animate-pulse hover:animate-none cursor-pointer",onClick:de},ut)):w("",!0)])]),c("section",pt,[c("article",null,g(e.$t("GLOBAL.GLOBAL_PRODUCT")),1),c("article",null,[P(M,{data:J.value,breakTime:Y.value,timeRange:Q.value,sumPiece:X.value},null,8,["data","breakTime","timeRange","sumPiece"])]),c("article",vt,[c("div",gt,[c("p",null,g(h(F)),1),c("p",ht,g(e.$t("LineBalance.LB_LINEINFO_TARGET")),1)]),c("div",ft,[c("p",null,g(h(me)),1),c("p",mt,g(e.$t("LineBalance.LB_LINEINFO_ACHIEVE")),1)]),c("div",xt,[c("p",null,g(h(ke)),1),c("p",yt,g(e.$t("LineBalance.LB_LINEINFO_ETA")),1)])]),c("article",wt,[c("div",kt,[c("div",bt,[P(V,{data:h(xe),dataStr:h(xe)+"%",info:"LineBalance.LB_LINEINFO_ACH"},null,8,["data","dataStr","info"])])]),c("div",Lt,[c("div",Tt,[P(V,{data:h(ye).rate,dataStr:h(ye).on+" / "+h(ye).total,info:"LineBalance.LB_LINEINFO_ONLINE_MACHINE_NUMBER"},null,8,["data","dataStr","info"])])]),c("div",Bt,[c("div",It,[P(V,{data:h(we).ontimeEffRate,dataStr:h(we).ontimeEffRate+"%",info:"LineBalance.LB_LINEINFO_EFF"},null,8,["data","dataStr","info"])])]),c("div",Pt,[c("div",St,[P(V,{data:h(we).avgEffRate,dataStr:h(we).avgEffRate+"%",info:"LineBalance.LB_LINEINFO_AVGEFF"},null,8,["data","dataStr","info"])])])])]),c("section",Nt,[c("article",At,[c("div",null,g(e.$t("GLOBAL.GLOBAL_PROCESS")),1),ge.value.totalPage>1?(i(),o("div",Ct,[c("span",null,g(e.$t("LineBalance.LB_PROCESSINFO_PAGES"))+":",1),c("button",{onClick:he},Et),c("span",Ot,[c("span",null,g(ge.value.rightNowPage),1),_t,c("span",null,g(ge.value.totalPage),1)]),c("button",{onClick:fe},jt)])):w("",!0)]),c("article",null,[P(q,{data:pe.value,amountData:ue.value},null,8,["data","amountData"])]),c("article",null,[P(ve,{data:pe.value,amountData:ue.value},null,8,["data","amountData"])])]),c("section",Dt,[c("article",null,g(e.$t("GLOBAL.GLOBAL_MACHINE")),1),c("article",{class:v(["grid lg:grid-cols-3 md:grid-cols-2 sm:grid-cols-1",[K.value.length>4?"grid-cols-5 xl:grid-cols-4":"",4==K.value.length?"grid-cols-4":"",3==K.value.length?"grid-cols-3":"",K.value.length<=2?"grid-cols-5 xl:grid-cols-4":""]])},[(i(!0),o(d,null,u(K.value,((e,t)=>(i(),o("div",{key:"getMachineList"+t,class:"m-auto w-56 cardHeight bg-black bg-opacity-50 border-2 border-gray-800 rounded-lg shadow-xl"},[P(Ve,{machineInfo:e},null,8,["machineInfo"])])))),128))],2)])]))}},[["__scopeId","data-v-d7ee269e"]]);export{$t as default};
